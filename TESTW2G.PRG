FUNCTION TESTW2G()
MEMVAR GETLIST
CLEAR

PUBLIC RECORD_ID := ' '
PUBLIC WRK_DATE  := ' '
PUBLIC MONTH     := ' '
PUBLIC DAY       := ' '
PUBLIC YEAR      := ' '
PUBLIC STATE     := ' '
PUBLIC FORM_CNT  := 0
PUBLIC LOOP_CNT  := 0
PUBLIC PRINTER_INIT := ' '
PUBLIC GROSS     := 0
PUBLIC FED_WITH  := 0
PUBLIC STA_WITH  := 0

select 1
USE PAYEE INDEX PAYEE
SELECT 2
USE TICKET INDEX TICKET
SELECT 3
USE PAYER

SET DEVICE TO PRINT

SELECT 1

DO WHILE M->LOOP_CNT < 6

   ++M->LOOP_CNT 

   M->GROSS     := 0
   M->FED_WITH  := 0
   M->STA_WITH  := 0

   M->RECORD_ID := TICKET->RECORD_ID

   SELECT 2
   SEEK M->RECORD_ID

   IF .NOT. FOUND()
      SET DEVICE TO SCREEN
	  CLEAR
	  @ 05,02 SAY 'TICKET DATA NOT FOUND FOR FOLLOWING PAYEE: ' 
	  @ 06,02 SAY 'SSN: ' 
	  @ 06,08 SAY PAYEE->RECORD_ID
	  @ 08,02 SAY 'NAME: '
	  @ 08,08 SAY PAYEE->NAME
      RETURN (NIL)
   END-IF

   DO WHILE TICKET->RECORD_ID = M->RECORD_ID .AND. .NOT. EOF()
       M->GROSS    = TICKET->GROSS
       M->FED_WITH = TICKET->FED_WITH
	   M->STA_WITH = TICKET->STA_WITH

       ++M->FORM_CNT 

	   DO CASE 

	      CASE M->FORM_CNT = 1

		      @ 2,03 SAY PAYER->NAME
			  @ 2,59 SAY M->GROSS    PICTURE  '9,999,999.99'
			  @ 2,83 SAY M->FED_WITH PICTURE  '9,999,999.99'

			  @ 4,03 SAY PAYER->ADDRESS1
			  @ 4,59 SAY 'HORSE TRACK'

			  M->WRK_DATE := DTOC(TICKET->DATE_WON)
			  M->MONTH    := SUBSTR(M->WRK_DATE,1,2)
			  M->DAY      := SUBSTR(M->WRK_DATE,4,2)
			  M->YEAR     := SUBSTR(M->WRK_DATE,7,2)

			  @ 4,86 SAY M->MONTH
			  @ 4,92 SAY M->DAY
			  @ 4,98 SAY M->YEAR

			  @ 6,03 SAY RTRIM(PAYER->CITY) + ', ' + PAYER->STATE + ' ' + PAYER->ZIP
			  @ 6,59 SAY TICKET->TRANS
			  @ 6,83 SAY TICKET->RACE

			  @ 08,03 SAY PAYER->EIN
			  @ 08,32 SAY '248-398-1000'
			  @ 08,59 SAY TICKET->WINNINGS
			  @ 08,83 SAY TICKET->CASHIER

			  @ 10,03 SAY RTRIM(PAYEE->LAST_NAME) + ', ' + RTRIM(PAYEE->FIRST_NAME) + ' ' + PAYEE->MIDDLE_INT
			  @ 10,59 SAY SUBSTR(PAYEE->RECORD_ID,1,3) + '-' + ;
			              SUBSTR(PAYEE->RECORD_ID,4,2) + '-' + ;
			              SUBSTR(PAYEE->RECORD_ID,6,4)

		      @ 10,83 SAY TICKET->WINDOW

			  @ 12,03 SAY PAYEE->ADDRESS
		      @ 12,59 SAY PAYEE->FIRST_ID
			  @ 12,83 SAY PAYEE->SECOND_ID

		      @ 14,03 SAY RTRIM(PAYEE->CITY) + ', ' + PAYEE->STATE + ' ' + PAYEE->ZIP	  

		      @ 14,83 SAY M->STA_WITH PICTURE '9,999,999.99'

	     CASE M->FORM_CNT = 2

		      @ 24,03 SAY PAYER->NAME

			  @ 24,59 SAY M->GROSS    PICTURE  '9,999,999.99'
			  @ 24,83 SAY M->FED_WITH PICTURE  '9,999,999.99'

			  @ 26,03 SAY PAYER->ADDRESS1
			  @ 26,59 SAY 'HORSE TRACK'

			  M->WRK_DATE := DTOC(TICKET->DATE_WON)
			  M->MONTH    := SUBSTR(M->WRK_DATE,1,2)
			  M->DAY      := SUBSTR(M->WRK_DATE,4,2)
			  M->YEAR     := SUBSTR(M->WRK_DATE,7,2)

			  @ 26,86 SAY M->MONTH
			  @ 26,92 SAY M->DAY
			  @ 26,98 SAY M->YEAR

			  @ 28,03 SAY RTRIM(PAYER->CITY) + ', ' + PAYER->STATE + ' ' + PAYER->ZIP
			  @ 28,59 SAY TICKET->TRANS
			  @ 28,83 SAY TICKET->RACE

			  @ 30,03 SAY PAYER->EIN
			  @ 30,32 SAY '248-398-1000'
			  @ 30,59 SAY TICKET->WINNINGS
			  @ 30,83 SAY TICKET->CASHIER

			  @ 32,03 SAY RTRIM(PAYEE->LAST_NAME) + ', ' + RTRIM(PAYEE->FIRST_NAME) + ' ' + PAYEE->MIDDLE_INT

			  @ 32,59 SAY SUBSTR(PAYEE->RECORD_ID,1,3) + '-' + ;
			              SUBSTR(PAYEE->RECORD_ID,4,2) + '-' + ;
			              SUBSTR(PAYEE->RECORD_ID,6,4)

		      @ 32,83 SAY TICKET->WINDOW

			  @ 34,03 SAY PAYEE->ADDRESS
		      @ 34,59 SAY PAYEE->FIRST_ID
			  @ 34,83 SAY PAYEE->SECOND_ID

		      @ 36,03 SAY RTRIM(PAYEE->CITY) + ', ' + PAYEE->STATE + ' ' + PAYEE->ZIP	  

		      @ 36,83 SAY M->STA_WITH PICTURE '9,999,999.99'

	     CASE M->FORM_CNT = 3

		      @ 46,03 SAY PAYER->NAME
			  @ 46,59 SAY M->GROSS    PICTURE  '9,999,999.99'
			  @ 46,83 SAY M->FED_WITH PICTURE  '9,999,999.99'

			  @ 48,03 SAY PAYER->ADDRESS1

			  @ 48,59 SAY 'HORSE TRACK'

			  M->WRK_DATE := DTOC(TICKET->DATE_WON)
			  M->MONTH    := SUBSTR(M->WRK_DATE,1,2)
			  M->DAY      := SUBSTR(M->WRK_DATE,4,2)
			  M->YEAR     := SUBSTR(M->WRK_DATE,7,2)

			  @ 48,86 SAY M->MONTH
			  @ 48,92 SAY M->DAY
			  @ 48,98 SAY M->YEAR

			  @ 50,03 SAY RTRIM(PAYER->CITY) + ', ' + PAYER->STATE + ' ' + PAYER->ZIP

			  @ 50,59 SAY TICKET->TRANS
			  @ 50,83 SAY TICKET->RACE

			  @ 52,03 SAY PAYER->EIN
			  @ 52,32 SAY '248-398-1000'
			  @ 52,59 SAY TICKET->WINNINGS
			  @ 52,83 SAY TICKET->CASHIER

			  @ 54,03 SAY RTRIM(PAYEE->LAST_NAME) + ', ' + RTRIM(PAYEE->FIRST_NAME) + ' ' + PAYEE->MIDDLE_INT

			  @ 54,59 SAY SUBSTR(PAYEE->RECORD_ID,1,3) + '-' + ;
			              SUBSTR(PAYEE->RECORD_ID,4,2) + '-' + ;
			              SUBSTR(PAYEE->RECORD_ID,6,4)

		      @ 54,83 SAY TICKET->WINDOW

			  @ 56,03 SAY PAYEE->ADDRESS
		      @ 56,59 SAY PAYEE->FIRST_ID
			  @ 56,83 SAY PAYEE->SECOND_ID

		      @ 58,03 SAY RTRIM(PAYEE->CITY) + ', ' + PAYEE->STATE + ' ' + PAYEE->ZIP	  

		      @ 58,83 SAY M->STA_WITH PICTURE '9,999,999.99'
	          
			  M->FORM_CNT := 0

		 END-CASE
     SKIP
     END-WHILE

     SELECT 1
	 SKIP
END-WHILE
@0,0 SAY ' '
SET DEVICE TO SCREEN
CLEAR
@18,02 SAY 'PRINT COMPLETE'
RETURN (NIL)
